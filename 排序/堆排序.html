<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>堆排序</title>
</head>
<body>
<script>
    var nums=[5,2,3,1]
    var sortArray=function(nums){
        /*构建大顶堆*/
        var len=nums.length;
        buildMaxHeap(nums,len);
        for (let i=nums.length-1;i>=0;i--){
            /*第一个（也就是当前数组中最大的值）和最后一个交换*/
            swap(nums,i,0);
            len--;/*此时的数组长度减1*/
            /*调整堆结构*/
            heapify(nums,0,len);
        }
        return nums;
    };
    
    function buildMaxHeap(nums,len){
        /*len=nums.length;*/
        for (let i=Math.floor(len/2)-1;i>=0;i--){
            heapify(nums,i,len);
        } 
    }
    
    function swap(nums,i,j){
        let temp=nums[i];
        nums[i]=nums[j];
        nums[j]=temp;
    }
    
    function heapify(nums,i,len){
          let left=i*2+1,right=2*i+2,target=i;
          if (left<len&&nums[left]>nums[target]){
              target=left;
          }
          if (right<len&&nums[right]>nums[target]){
              target=right;
          }
          if (target!==i){
              swap(nums,i,target);
              heapify(nums,target);
          }
    }


    console.log(sortArray(nums))
    
</script>
</body>
</html>